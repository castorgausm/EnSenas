{% extends 'base.html' %}
{% load static %}

{% block title %}Lecciones{% endblock %}

{% block navlinks %}
    <li><a href="{% url 'home' %}">Hogar</a></li>
    <li><a href="{% url 'manual' %}">Manual</a></li>
    <li><a href="{% url 'lessons_list' %}">Lecciones</a></li>
    <li><a href="{% url 'profile' %}" class="purplebutton"><span>Perfil</span></a></li>
{% endblock %}

{% block main %}
    <div class="lesson-container">
        <div class="lesson-content">
            <div class="lesson-images">
                <ul> 
                    {% for imagen in lesson_images %} 
                        <li><img src="{{imagen.image.url}}" alt="Lesson Image"></li> 
                    {% endfor %} 
                </ul>
            </div>
            <div class="lesson-question">
                <p>{{ lesson.question }}</p>
            </div>
            <div class="lesson-response">
                <input type="text" id="user-response" placeholder="Escribe tu respuesta">
                <button id="submit-response" data-lesson-id="{{ lesson.id }}">Enviar Respuesta</button>
                <div id="response-result"></div>
            </div>
        </div>
    </div>

    <style>
        .lesson-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .lesson-content {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
        }
        .lesson-images ul {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        .lesson-images li {
            margin: 10px;
        }
        .lesson-images img {
            max-width: 200px; /* Aumentar el tamaño máximo de las imágenes */
            border-radius: 8px;
        }
        .lesson-question {
            margin: 20px 0;
            font-size: 18px;
            font-weight: bold;
        }
        .lesson-response {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .lesson-response input {
            padding: 10px;
            margin-bottom: 10px;
            width: 100%;
            max-width: 400px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .lesson-response button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .lesson-response button:hover {
            background-color: #45a049;
        }
        #response-result {
            margin-top: 10px;
            font-size: 16px;
        }
    </style>

    <script>
        document.getElementById('submit-response').addEventListener('click', function() {
            const userResponse = document.getElementById('user-response').value;
            const lessonId = this.getAttribute('data-lesson-id');

            fetch(`responder/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({
                    'respuesta': userResponse
                }) 
            })
            .then(response => response.json())
            .then(data => {
                const resultDiv = document.getElementById('response-result');
                if (data.correct) {
                    resultDiv.innerHTML = 'Respuesta Correcta!';
                    resultDiv.style.color = 'green';
                } else {
                    resultDiv.innerHTML = 'Respuesta Incorrecta';
                    resultDiv.style.color = 'red';
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    </script>
{% endblock %}
